## 区块链



#### **区块链定义：** 

1.狭义：区块链是一种链式数据结构，通过按时间顺序将数据块逐一连接形成。这种结构通过密码学确保了数据的不可篡改性和不可伪造性，形成了一种分布式账本技术。

2.广义：区块链技术不仅仅是一种数据存储方式，它结合了块链式数据结构、分布式节点共识机制、密码学安全措施以及智能合约等多种技术。通过这些技术，区块链确保了数据的安全传输和访问，同时利用智能合约对数据进行自动化的编程和操作。这种技术合集为我们提供了一个全新的、分布式的基础架构和计算平台。

**特点：**

**1.数据完整性的保障：**区块的生成伴随着严格的密码学验证。数据被记录在区块中并通过网络确认，它就难以被删除或更改，只能被查询。保障了数据的完整性和安全性。

**2.数据共识性的保障：**共识机制确保所有节点在数据块可被添加到链上之前，必须获得网络中大多数节点的验证和确认。保证了区块数据的一致性和公正性。

**3.系统健壮性的保障：** 区块链的数据被网络中的所有节点共同保存，形成了一个强大的、去中心化的存储网络。每个节点都持有数据的完整备份，这种分布式的存储架构极大地增强了系统的健壮性和抗攻击能力。

#### **区块链类型：**

**公链（Public Blockchain）：**

1. 公链是一种**完全去中心化**的区块链形式
2. **交易信息公开透明**，任何人都可以进行交易和访问数据，可以随意加入或退出网络节点，参与者的**真实身份保持匿名**
3. 公链的主要缺点在于**交易成本较高**，因为每笔交易需要得到大多数节点的验证。

**联盟链（Consortium Blockchain）：**

1. 联盟链是**部分去中心化**的区块链，加入节点需要进行**验证和授权**
2. 节点根据预设的共识机制协调工作，适合**多个机构共同管理和操作**的场景，如供应链金融和跨境清算
3. 设计允许各组件根据应用需求灵活选择和配置，支持共识机制的可插拔性。

**私链（Private Blockchain）:**

1. 私链是一种**仅向特定个人或实体开放**的区块链系统
2. 每个**节点权限由中心组织分配**，并且组织还决定向每个节点开放的数据量
3. 主要优势在于**交易成本低且速度快**，因为交易验证不需要网络中的每个节点参与，只需少数节点即可完成处理
4. 私链提供了**更高的数据保密性**，只有获得授权的参与者才能访问相关的链上数据，特别适用于需要严格监管的场景

**三种区块链的核心区别:**

1. 主要区别在于**访问权限的开放程度或者说去中心化程度**
2. **公链提供最高程度的去中心化**，任何人都可以参与验证和记录交易，提供了较高的信任和安全性，交易效率相对较低
3. **联盟链和私链的去中心化程度较低**，是由多个组织共同管理和运营
4. **私链通常由单一企业或组织控制**
5. **联盟链和私链都属于许可链（Permissioned Blockchain）**，节点的加入需要通过认证和授权，在交易效率和组织内部的数据流通上更为高效

**区块链是一个分布式账本，相当于一个去中心化的银行记账系统，利用密码学技术构建了一个去信任的网络，是一个确保数据最终一致性的分布式数据库**

### 区块链 1.0 -- 数字货币

- 区块链 1.0 阶段，区块链技术主要应用于数字货币领域。
- 比特币核心创新在于解决了“双花问题”（即同一笔资金被重复使用的问题）和“拜占庭将军问题”（即如何在不可靠的节点中达成一致性的问题）
- 数字货币在技术架构上一般分为三层：

​			1.区块链层：数字货币系统的基础技术和最核心部分，负责实现系统的共识过程、消息传递等关键功能。

​			2.协议层：为系统提供软件服务，制定运行规则等。

​			3.货币层：作为价值表示，主要用于用户间的价值转移，相当于货币单位。

### 区块链 2.0 -- 智能合约

1. 随着比特币及其他山寨币在资源消耗和处理复杂逻辑上的限制逐渐显现，业界开始转向区块链这一底层技术，从而催生了智能合约的概念。
2. 智能合约是一种运行在区块链上的自动执行的、可编程的脚本，极大扩展了区块链的应用范围，延伸到更广泛的商业领域，如金融交易、证券清算、身份认证等。
3. 以太坊成为这一阶段的标志性平台，它不仅是一个区块链基础开发平台，还提供了图灵完备的智能合约系统。
4. 以太坊平台上当前运行着众多去中心化应用，这些应用根据其白皮书可以分为三类：

- 金融应用：涵盖数字货币、金融衍生品、对冲合约、储蓄钱包、遗嘱等，主要涉及金融交易和价值传递。
- 半金融应用：这些应用虽涉及金钱交易，但同时包含大量非金钱相关的功能。
- 非金融应用：如在线投票和去中心化自治组织等，完全不涉及金融交易。

### 区块链 3.0--超越货币、经济和市场

随着技术的不断进步，区块链有望超越其在金融领域的应用，拓展到社会公证和智能化领域——这就是所谓的区块链 3.0。在这一阶段，区块链的应用将可能覆盖社会治理的各个方面，如身份认证、公证、仲裁、审计、域名管理、物流、医疗服务、电子邮件、签证处理和投票系统等。

**挑战**：

- **可扩展性问题：**主流区块链平台在处理交易的效率方面远不足以满足传统企业级应用的需求。这些平台的交易处理速度和效率必须大幅提升，以便于支撑更广泛的商业和社会应用。
- **隐私保护：**尽管区块链的公开透明特性是其核心优势之一，它也允许通过区块链浏览器查看其他用户的交易和数据，这在隐私保护上造成了挑战。虽然如达世币、门罗币和大零币等项目在加强交易隐私方面做出了努力，这些努力主要局限于数字货币领域。在 3.0 时代，区块链将用于存储更多敏感数据类型，如医疗记录和个人信用信息，用户显然不希望这些高度敏感的个人信息被公开。
- **合法合规问题：**区块链的开放性和匿名性为政府监管带来了严峻的挑战。要确保区块链技术的健康发展，其必须在政府的监管框架内进行操作。适当的监管措施不仅可以保护用户利益，还能在权利受损时提供维权途径。

## 核心技术

### **P2P（点对点）网络通信技术**

1. 是一种没有中心服务器的网络结构，每个参与者既充当客户端也充当服务器
2. 优势：
   1. **快速且保障隐私**： 由于用户之间的通信不需要经过服务器中转，可以直接进行，这不仅提高了通信速度，还增强了隐私保护，因为数据传输不被第三方处理或查看。
   2. **数据容错性**： 在 P2P 网络中，数据是分布式存储在各个节点上的，每个节点可能存储全量或部分数据，这提供了足够的数据冗余。例如，在比特币的区块链系统中，每个节点都存储了全部的区块链数据。这种设计减少了单点故障的风险，提高了数据的可靠性。
   3. **稳定性**： P2P 网络的去中心化特性意味着任何单一节点的退出或故障都不会导致整个系统瘫痪，从而确保了系统的整体稳定性。

### **分布式账本技术（DLT）**

1. 是一种先进的去中心化数据存储方法，它允许数据在网络中的多个节点上进行分享、复制和同步
2. 特点：
   1. **更高的效率**： DLT 采用基于共识规则的多方决策和共同维护的数据管理方式，其去中心化的特性能有效减轻系统负担
   2. **更高的安全性**：DLT 系统中，每个节点都独立拥有完整的数据备份，节点间彼此独立，权限平等，通过周期性或事件驱动的共识机制达成数据存储的最终一致性。因此，任何未授权的数据修改或外部攻击都需要同时影响到大多数节点，才能对系统造成实际影响，极大增强了数据的安全性。

### **共识算法**

1. 在去中心化的系统中，维持节点间数据一致性的关键在于共识算法

2. 共识算法可以分为三类：

   - 证明类：包括 PoW 和 PoS。PoW 通过验证节点的计算能力来选取记账节点；PoS 则基于节点所持有的系统资源的权益来选择。
   - 随机类：如 Algorand 和 POET（Proof of Elapsed Time），这类算法通常依赖随机数来选择负责打包新区块的节点。
   - 联盟类：如 DPoS，这是一种民主集中式的方法，节点通过投票决定哪些代表节点轮流获得记账权。

3. 工作证明（Proof of Work, PoW）：

   1. **工作原理**：在 PoW 系统中，参与节点（矿工）必须使用计算资源来解决一个加密难题，通常涉及寻找特定的哈希值。这个挖矿过程不仅耗费大量电力和计算资源，而且是竞争性的。第一个成功解决难题的节点获得权利将新区块添加到区块链上，并从中获得区块奖励，包括新生成的加密货币和交易费。

   2. ##### 优缺点：

      1. 优点：
         - 高安全性：篡改链中已有区块将需要重新计算大量工作量，使得攻击成本变得非常高。
         - 去中心化：理论上，任何人都有机会通过挖矿参与网络维护，增强了网络的去中心化特性。
      2. 缺点：
         - 高能源消耗：这种算法因其巨大的能源消耗而饱受批评，被认为不环保。
         - 挖矿集中化：随着挖矿设备的专业化，大规模的挖矿操作使得小规模矿工难以竞争，逐渐导致挖矿活动的集中化。

4. 权益证明（Proof of Stake, PoS）：

   1. **工作原理**：在 PoS 机制下，每个持币者可以将自己的货币按照一定的数量和时间抵押作为“权益”。系统通过随机选择或依据特定算法从抵押的节点中选出下一个区块的生成者。通常情况下，持有更多货币的节点获得被选中的概率更高。
   2. **优缺点**：
      1. 优点：
         - 能效高：相比 PoW，PoS 几乎不消耗电力，极大地减少了能源消耗。
         - 降低成本：减少了对挖矿资源和设备的需求，使得参与的门槛较低。
      2. 缺点：
         - 富者更富：持有大量币的个体或组织可能因此拥有更大的影响力，增加了系统中的财富不平等。
         - 缺乏长期实战测试：与 PoW 相比，PoS 在大规模和长期运行的网络中还缺少实战测试。

5. 委托权益证明（Delegated Proof of Stake, DPoS）：

   1. **工作原理**：在 DPoS 系统中，持币者通过投票选举出一定数量的“代表”，这些代表有责任验证交易和创建新的区块。持币者的投票权重根据其持有的币量来决定，使得每个参与者都能通过投票影响网络治理。
   2. **优缺点**：
      1. 优点：
         - 高效率：DPoS 能够快速处理交易，适应更大的交易量，提高了网络的整体效率。
         - 参与性：通过投票机制，使所有币持有者都能直接参与到网络治理中，增加了用户的参与感和影响力。
      2. 缺点：
         - 权力集中：选举制可能导致网络权力过度集中在少数代表手中，引发权力滥用的风险。
         - 代表依赖性：系统的安全和效率依赖于选出的代表的诚信和能力，若代表行为不端，可能危及整个网络的安全。

6. 拜占庭容错（Byzantine Fault Tolerance, BFT）：

   1. **工作原理**：BFT 算法通过节点间的密集通信来达成共识。当系统中超过三分之二的节点同意某个决策时，该决策被认为是有效的。这一过程通常涉及多轮通信，以确保所有参与节点对决策达成一致。
   2. **优缺点**：
      1. 优点：
         - 高容错性：BFT 算法可以有效抵抗少数节点的失败或恶意攻击，确保系统稳定运行。
         - 快速确认时间：BFT 能够快速达成共识，特别适用于需要快速交易确认的应用场景。
      2. 缺点：
         - 规模限制：随着网络节点数量的增加，所需进行的通信量会急剧增加，使得 BFT 不适合应用于大规模网络。
         - 高通信成本：BFT 要求高带宽以支持密集的通信，从而导致较高的通信成本。

7. 权威证明（Proof of Authority, PoA）：

   1. **工作原理**：在 PoA 模式下，被授权的权威节点（通常是事先经过严格验证的实体或个人）负责处理所有交易和创建新的区块。这些节点由于其身份的公开性和可验证性，被信任不会进行恶意操作，从而保证网络的稳定和安全。
   2. **优缺点**：
      1. 优点：
         - 高效与透明：处理交易迅速，运行高效，非常适合需要快速交易确认的应用场景。
         - 低能耗：与工作量证明（PoW）和权益证明（PoS）相比，PoA 的能源消耗显著较低。
      2. 缺点：
         - 中心化风险：由于系统的安全和稳定高度依赖于少数节点，这增加了中心化的风险。
         - 安全脆弱性：如果权威节点遭到攻击或其安全性受到威胁，整个网络的安全和稳定都可能受到严重影响。



### 密码算法

#### 4.1 非对称加密算法

- 非对称加密使用两个密钥：
- 在加解密场景中，公钥用于加密，私钥用于解密；
- 在数字签名场景中，私钥用于加密，公钥用于解密（验证）。数字签名的主要目的不是解密数据，而是验证数据的完整性和来源的真实性。
- 当前大多数区块链系统采用基于 secp256k1 的椭圆曲线加密算法。

#### 4.2 哈希算法

- 哈希算法，也称为摘要或散列算法，是将任意长度的数据压缩成固定长度输出的单向函数，具有不可逆和碰撞性极低的特性。
- 有效的哈希算法具有非常低的碰撞概率。主要应用包括数据校验和数据摘要等。常见的哈希算法包括 MD5, SHA-1, RipeMD-160, SHA-256, 和 SHA-512 等。

#### 4.3 编解码算法

- 编码的目的是使一串长且无规则的字符串变得精简且可读，并非加密数据。根据所使用的编解码算法，数据可以直接解码。
- 比如在比特币中使用的是 Base58 编码，该编码基于 Base64，但去除了一些容易与其他字符混淆的字符，如数字 0，大写的'O'，小写的'l'，和大写的'I'。

### 嵌入式数据库

- 为了最大限度地降低时延，区块链系统通常采用嵌入式数据库。
- 嵌入式数据库是一种轻量级数据库，它直接运行在本地机器上，无需启动专门的服务端。
- 嵌入式数据库与应用程序紧密集成，随应用启动而启动，随应用终止而终止。
- 常见的嵌入式数据库包括 SQLite、BerkeleyDB、LevelDB 和 CouchDB。

**优势：**

- 高效率：嵌入式数据库直接通过应用程序调用 API 进行数据操作，无需运行独立的数据引擎。
- 体积小巧：最初为嵌入式系统设计，嵌入式数据库的体积较小，占用资源少，包括 ROM、RAM 和 CPU。
- 功能全面：尽管体积小，但功能完备，包括日志管理、数据压缩、备份及恢复等。
- 高可移植性：与关系型数据库相比，嵌入式数据库具有更好的兼容性，适用于多种软硬件平台。

### 智能合约

- 智能合约是一种在区块链平台上运行的程序代码，它能在预定条件被满足时自动执行合约中的条款。
- 智能合约由以太坊平台首次引入，目前以太坊和 Hyperledger Fabric 是在此领域内最为成熟且具有代表性的平台。

#### 工作流程

1. 合约创建：多方用户共同参与编写并确定一份智能合约。
2. 合约部署：合约通过 P2P 网络广播并存储在区块链中。
3. 合约触发：等待外部事件（如时间、交易等）触发合约的自动执行。

#### 特点

- 不可篡改：一旦合约被上传至区块链，它将永久存储且无法更改。
- 安全执行：合约在区块链的每个全节点上都在一个安全的沙盒环境中执行，确保执行过程不受外部环境影响。只有当所有节点上的执行结果一致时，合约才视为成功执行。
- 透明性：合约的执行结果被记录在区块链上，确保了结果的公正性和透明性。

#### 问题

由于智能合约是由程序员编写，可能存在代码漏洞，如浮点溢出、访问控制错误、返回值错误、拒绝服务等，有时甚至包括故意的漏洞。这些漏洞由于区块链的不可篡改性，一旦被利用，可能导致严重后果。2016 年以太坊的 The DAO 事件是一个典型例子。





​	











